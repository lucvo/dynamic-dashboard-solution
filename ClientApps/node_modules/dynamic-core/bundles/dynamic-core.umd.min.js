!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("tslib"),require("@angular/router"),require("@angular/common")):"function"==typeof define&&define.amd?define("dynamic-core",["exports","@angular/core","rxjs","rxjs/operators","tslib","@angular/router","@angular/common"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["dynamic-core"]={},e.ng.core,e.rxjs,e.rxjs.operators,e.tslib,e.ng.router,e.ng.common)}(this,(function(e,t,n,o,r,a,i){"use strict";var s=function(){};s.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new s},token:s,providedIn:"root"}),s.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}];var c=function(e){var t=this;this.settingsService=e,this.historyState=[],this.subject=new n.BehaviorSubject(this.historyState),this.setState=function(e){t.subject.next(e)},this.addItem=function(e){var n=t.subject.getValue();-1===n[0].items.indexOf(e)&&-1===n[1].items.indexOf(e)?(n[0].items.length<=n[1].items.length?n[0].items.push(e):n[1].items.push(e),t.subject.next(n)):console.warn("Item with the same id exists on the dashboard.")},this.removeItem=function(e){var n=t.subject.getValue();n.forEach((function(t){t.items.forEach((function(n,o){n===e&&t.items.splice(o,1)}))})),t.subject.next(n)},this.loadContents=function(e){return t.settingsService.loadSettings(e).pipe(o.map((function(e){return t.historyState=e,t.subject.next(t.historyState),e})))}};c.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new c(t.ɵɵinject(s))},token:c,providedIn:"root"}),c.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],c.ctorParameters=function(){return[{type:s}]};var u=function(e){this.viewContainerRef=e};u.decorators=[{type:t.Directive,args:[{selector:"[appLayouOutlet]"}]}],u.ctorParameters=function(){return[{type:t.ViewContainerRef}]},u.propDecorators={item:[{type:t.Input}]};var p=new t.InjectionToken("DYNAMIC_MODULES_MAP"),d=function(){function e(e,n,o,a,i,s){var c=this;this.cd=e,this.injector=n,this.compiler=o,this.service=a,this.route=i,this.modulesMap=s,this.containers=[],this.loadContents=function(){c.dashboardOutlet&&c.dashboardOutlet.length&&(c.dashboardOutlet.forEach((function(e){c.cd.detectChanges(),c.loadContent(e,e.item)})),c.cd.detectChanges())},this.loadContent=function(e,n){return r.__awaiter(c,void 0,void 0,(function(){var o,a,i,s,c,u,p;return r.__generator(this,(function(r){switch(r.label){case 0:return n.name?((o=e.viewContainerRef).clear(),[4,this.modulesMap[n.name].load()]):[2];case 1:return(a=r.sent())instanceof t.NgModuleFactory?(i=a,[3,4]):[3,2];case 2:return[4,this.compiler.compileModuleAsync(a)];case 3:i=r.sent(),r.label=4;case 4:return s=i.create(this.injector),console.log(n.cName),c=i.moduleType.entryComponents[n.cName+"ContainerComponent"],u=s.componentFactoryResolver.resolveComponentFactory(c),p=o.createComponent(u),p.instance.item=n,[2]}}))}))},this.changed=function(e,t){var n=c.containers;n[t].items=e,c.service.setState(n)}}return e.prototype.ngOnInit=function(){var e=this,t=this.route.snapshot.params.id;this.service.loadContents(t).pipe(o.tap((function(t){return e.containers=t}))).subscribe((function(){e.cd.detectChanges(),e.loadContents()}))},e.prototype.ngAfterViewInit=function(){},e}();d.decorators=[{type:t.Component,args:[{template:" "}]}],d.ctorParameters=function(){return[{type:t.ChangeDetectorRef},{type:t.Injector},{type:t.Compiler},{type:c},{type:a.ActivatedRoute},{type:void 0,decorators:[{type:t.Inject,args:[p]}]}]},d.propDecorators={dashboardOutlet:[{type:t.ViewChildren,args:[u]}]};var l=function(e){function t(t,n,o,r,a,i){return e.call(this,t,n,o,r,a,i)||this}return r.__extends(t,e),t}(d);l.decorators=[{type:t.Component,args:[{selector:"app-layout",template:'<div class="p-grid">\n  <div class="p-col" *ngFor="let container of containers">\n    <div class="box" *ngFor="let item of container.items">\n      <ng-template appLayouOutlet [item]="item"></ng-template>\n    </div>\n  </div>\n</div>',styles:[""]}]}],l.ctorParameters=function(){return[{type:t.ChangeDetectorRef},{type:t.Injector},{type:t.Compiler},{type:c},{type:a.ActivatedRoute},{type:void 0,decorators:[{type:t.Inject,args:[p]}]}]};var m=function(){};m.decorators=[{type:t.Component,args:[{selector:"app-template-card",template:""}]}];var f=function(){};f.decorators=[{type:t.Component,args:[{template:""}]}],f.propDecorators={item:[{type:t.Input}]};var h=function(){};h.decorators=[{type:t.NgModule,args:[{declarations:[d,l,u,m,f],imports:[i.CommonModule],exports:[d,l,u,m,f]}]}],e.BaseLayoutComponent=d,e.BaseSettingsService=s,e.DYNAMIC_MODULES_MAP=p,e.DashboardService=c,e.DynamicLayoutModule=h,e.LayoutComponent=l,e.LayoutOutletDirective=u,e.TemplateCardComponent=m,e.TemplateCardContainer=f,e.ɵa=d,e.ɵb=l,e.ɵc=u,e.ɵd=m,e.ɵe=f,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=dynamic-core.umd.min.js.map